2021-11-02 23:28:58,954 [INFO] core.trainer: {'data_root': '/content/miniImageNet--ravi', 'image_size': 84, 'use_memory': False, 'augment': True, 'augment_times': 1, 'augment_times_query': 1, 'device_ids': 0, 'n_gpu': 1, 'seed': 0, 'deterministic': True, 'log_name': None, 'log_level': 'info', 'log_interval': 100, 'log_paramerter': False, 'result_root': '/content/LibFewShot/results', 'save_interval': 10, 'save_part': ['emb_func'], 'tag': None, 'epoch': 50, 'test_epoch': 5, 'parallel_part': ['emb_func'], 'pretrain_path': None, 'resume': False, 'way_num': 5, 'shot_num': 1, 'query_num': 15, 'test_way': 5, 'test_shot': 1, 'test_query': 15, 'episode_size': 1, 'train_episode': 100, 'test_episode': 100, 'batch_size': 128, 'optimizer': {'name': 'Adam', 'kwargs': {'lr': 0.001}, 'other': {'emb_func': 0.001}}, 'lr_scheduler': {'name': 'StepLR', 'kwargs': {'gamma': 0.5, 'step_size': 10}}, 'includes': ['headers/data.yaml', 'headers/device.yaml', 'headers/misc.yaml', 'headers/model.yaml', 'headers/optimizer.yaml', 'classifiers/Proto.yaml', 'backbones/Conv64F.yaml'], 'classifier': {'name': 'ProtoNet', 'kwargs': None}, 'backbone': {'name': 'Conv64F', 'kwargs': {'is_flatten': False, 'is_feature': False, 'leaky_relu': False, 'negative_slope': 0.2, 'last_pool': False, 'maxpool_last2': True}}, 'tb_scale': 1.0}
2021-11-02 23:28:59,032 [INFO] core.trainer: ProtoNet(
  (emb_func): Conv64F(
    (layer1): Sequential(
      (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
      (2): ReLU(inplace=True)
      (3): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    )
    (layer2): Sequential(
      (0): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
      (2): ReLU(inplace=True)
      (3): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    )
    (layer3): Sequential(
      (0): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
      (2): ReLU(inplace=True)
    )
    (layer3_maxpool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (layer4): Sequential(
      (0): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=False, track_running_stats=True)
      (2): ReLU(inplace=True)
    )
    (layer4_pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (proto_layer): ProtoLayer()
  (loss_func): CrossEntropyLoss()
)
2021-11-02 23:28:59,032 [INFO] core.trainer: Trainable params in the model: 112576
2021-11-02 23:29:18,482 [INFO] core.data.dataset: load 38400 image with 64 label.
2021-11-02 23:29:18,498 [INFO] core.data.dataset: load 9600 image with 16 label.
2021-11-02 23:29:18,510 [INFO] core.data.dataset: load 12000 image with 20 label.
2021-11-02 23:29:18,512 [INFO] core.trainer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.001
    lr: 0.001
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.001
    lr: 0.001
    weight_decay: 0
)
2021-11-02 23:29:18,513 [INFO] core.trainer: ============ Train on the train set ============
2021-11-02 23:30:05,324 [INFO] core.trainer: Epoch-(0): [100/100]	Time 0.219 (0.465)	Calc 0.036 (0.047)	Data 0.115 (0.351)	Loss 95.449 (252.286)	Acc@1 18.667 (27.347)
2021-11-02 23:30:05,325 [INFO] core.trainer:  * Acc@1 27.347 
2021-11-02 23:30:05,325 [INFO] core.trainer: ============ Validation on the val set ============
2021-11-02 23:30:47,718 [INFO] core.trainer: Epoch-(0): [100/100]	Time 0.142 (0.421)	Calc 0.033 (0.040)	Data 0.106 (0.374)	Acc@1 40.000 (26.973)
2021-11-02 23:30:47,720 [INFO] core.trainer:  * Acc@1 26.973 Best acc -inf
2021-11-02 23:30:47,720 [INFO] core.trainer: ============ Testing on the test set ============
